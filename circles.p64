picotron cartridge // www.picotron.net
version 2

:: gfx/
:: map/
:: sfx/
:: gfx/0.gfx
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTA0LTE2IDIyOjM1OjQ3Iixtb2RpZmllZD0iMjAyNC0w
NC0xNiAyMzoxNDozOSIscmV2aXNpb249MTA5XV1sejQAbQAAAAUxAADzFHtbMF09e2JtcD1weHUA
QyAQEATw8CxmbGFncz0wLHBhbl94CADPeT0wLHpvb209OH0sMQD-------------------------
---------------------------------------nUG09OH19
:: gfx/.info.pod
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTA0LTE2IDIyOjM1OjQ3IixzdG9yZWQ9IjIwMjQtMDQt
MTYgMjI6MzU6NDciXV1sejQABAAAAAMAAAAwbmls
:: main.lua
--[[pod_format="raw",created="2024-04-16 22:35:47",modified="2024-04-16 23:14:39",revision=206]]
include("qsort.lua")

function _init()
	objs = {}
	for i = 1,250 do
		local obj = {
			x = rnd(480),
			y = rnd(270),
			r = rnd(4),
			c = rnd(15)+1
		}
		add(objs, obj)
	end
	qsort(objs, function(a,b) return a.r<b.r end)
end

function _update()
	local mx,my = mouse()
	for obj in all(objs) do
		local dx = (240 - mx) * obj.r / -400
		local dy = (130 - my) * obj.r / -400
		obj.x += dx
		obj.y += dy
		if (obj.x - obj.r > 480) then obj.x = -obj.r end
		if (obj.x + obj.r < 0) then obj.x = 480 + obj.r end		
		if (obj.y - obj.r > 270) then obj.y = -obj.r end
		if (obj.y + obj.r < 0) then obj.y = 270 + obj.r end		
	end
end

function _draw()
	cls(0)
	for obj in all(objs) do
		circfill(obj.x, obj.y, obj.r, obj.c)
		circfill(obj.x, obj.y, obj.r, obj.c)
		circfill(obj.x, obj.y, obj.r, obj.c)
	end
end

:: map/0.map
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTA0LTE2IDIyOjM1OjQ3Iixtb2RpZmllZD0iMjAyNC0w
NC0xNiAyMzoxNDozOSIscmV2aXNpb249MTA5XV1sejQAVAAAAEQQAADwCHt7Ym1wPXVzZXJkYXRh
KCJpMTYiLDMyAwAvIjABAP--------------------uhIikscGFuX3g9MAgA0nk9MCx0aWxlX2g9
MTYKAGB3PTE2fX0=
:: map/.info.pod
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTA0LTE2IDIyOjM1OjQ3IixzdG9yZWQ9IjIwMjQtMDQt
MTYgMjI6MzU6NDciXV1sejQABAAAAAMAAAAwbmls
:: qsort.lua
--[[pod_format="raw",created="2024-04-16 22:56:53",modified="2024-04-16 23:14:39",revision=55]]
-- common comparators
function  ascending(a,b) return a<b end
function descending(a,b) return a>b end

-- a: array to be sorted in-place
-- c: comparator (optional, defaults to ascending)
-- l: first index to be sorted (optional, defaults to 1)
-- r: last index to be sorted (optional, defaults to #a)
function qsort(a,c,l,r)
    c,l,r=c or ascending,l or 1,r or #a
    if l<r then
        if c(a[r],a[l]) then
            a[l],a[r]=a[r],a[l]
        end
        local lp,rp,k,p,q=l+1,r-1,l+1,a[l],a[r]
        while k<=rp do
            if c(a[k],p) then
                a[k],a[lp]=a[lp],a[k]
                lp+=1
            elseif not c(a[k],q) then
                while c(q,a[rp]) and k<rp do
                    rp-=1
                end
                a[k],a[rp]=a[rp],a[k]
                rp-=1
                if c(a[k],p) then
                    a[k],a[lp]=a[lp],a[k]
                    lp+=1
                end
            end
            k+=1
        end
        lp-=1
        rp+=1
        a[l],a[lp]=a[lp],a[l]
        a[r],a[rp]=a[rp],a[r]
        qsort(a,c,l,lp-1       )
        qsort(a,c,  lp+1,rp-1  )
        qsort(a,c,       rp+1,r)
    end
end
:: sfx/0.sfx
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTA0LTE2IDIyOjM1OjQ4Iixtb2RpZmllZD0iMjAyNC0w
NC0xNiAyMzoxNDozOSIscmV2aXNpb249MTA4XV1sejQAEQEAAMEIAADwJ3B4dQADKAAAAwAED0AQ
Ag4AAaABIAKgDgAPEAAN8MoBAgMEBQYHAA--kAgJCgsPDA8NDw4PDxAA8AANDxEPEg8TDxQPFQ8W
DxcTAPEBDxgPGQ8aDxsPHA8dDx4PHxQA8QAgDyEPIg8jDyQPJQ8mDycUAPEAKA8pDyoPKw8sDy0P
Lg8vFADxADAPMQ8yDzMPNA81DzYPNxQA-wU4DzkPOg87DzwPPQ8_Dz8AD--w-wEA6-8nWgEQBg8g
EAEgASAB8AACEAIMEAEgDyEgATAPQPDDDygP--DGD-gKD-8PgA-3Dw0B8AkBEAYMMAD--7of-wEA
zL-oD0AADUD--7DwcAoA--9kH-8BAJdQ-----x8=
:: sfx/.info.pod
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTA0LTE2IDIyOjM1OjQ3IixzdG9yZWQ9IjIwMjQtMDQt
MTYgMjI6MzU6NDciXV1sejQABAAAAAMAAAAwbmls
:: .info.pod
b64$LS1bW3BvZCxydW50aW1lPTUsc3RvcmVkPSIyMDI0LTA0LTE2IDIzOjE0OjM5Iix3b3Jrc3Bh
Y2VzPXt7bG9jYXRpb249Im1haW4ubHVhIzEyIix3b3Jrc3BhY2VfaW5kZXg9MX0se2xvY2F0aW9u
PSJxc29ydC5sdWEjNDEiLHdvcmtzcGFjZV9pbmRleD0xfSx7bG9jYXRpb249ImdmeC8wLmdmeCIs
d29ya3NwYWNlX2luZGV4PTJ9LHtsb2NhdGlvbj0ibWFwLzAubWFwIix3b3Jrc3BhY2VfaW5kZXg9
M30se2xvY2F0aW9uPSJzZngvMC5zZngiLHdvcmtzcGFjZV9pbmRleD00fX1dXWx6NAAEAAAAAwAA
ADBuaWw=
:: [eoc]
